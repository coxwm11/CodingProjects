package secretWriting;

import java.util.Scanner;
import java.lang.Throwable;
import java.io.*;

public class SecretWriting {

	// Method for encoding User's message
	public static String encryptMessage(String userInput, String originalAlphabet, String keyEncoded) {
		String spaceOutput = "";

		for (int i = 0; i < userInput.length(); i++) {

			char keyCharacter;
			char messageCharacter = userInput.charAt(i);
			int inputIndex = originalAlphabet.indexOf(messageCharacter);
			try {

				keyCharacter = keyEncoded.charAt(inputIndex);

			} catch (StringIndexOutOfBoundsException e) {

				keyCharacter = messageCharacter;

			}

			spaceOutput += keyCharacter;

		}

		return spaceOutput;

	}
	
	
	

	public static void main(String[] args) throws IOException {

		// Introduction
		System.out.print("Welcome to the Encoder/ Decoder Program \n");
		System.out.print("-----------------------------------------\n");
		System.out.print("Enter E to encode a message. \n");
		System.out.print("Enter D to decode a message. \n");
		System.out.print("Enter Q to quit the program. \n");
		System.out.print("Enter your choice: ");
		

		// User input
		Scanner scan = new Scanner(System.in);
		String input = scan.nextLine();
		String fileOutName;
		
		
while(input.charAt(0) != 'q'){
		
		
		do {
			
		
			// Begins Encoding Process
			if (input.charAt(0) == 'E' || input.charAt(0) == 'e') {

			// Create input and output file streams
			BufferedReader in = null;
			PrintWriter outputStream = null;
			String encryptMethod;

			try {
				System.out.println("");
				System.out.println("");
				
				//User inputs the file name they are searching for
				System.out.print("Enter the name of the file that contains the code:");
				input = scan.nextLine();

				// This code reads the file that was selected by the user
				in = new BufferedReader(new FileReader(input));
				String keyEncoded = in.readLine();
				
				//Original alphabet string
				String alphabetIndex = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";

				// User puts the name of the desired output file
				System.out.print("Enter the name of the output file:");
				fileOutName = scan.nextLine();
				outputStream = new PrintWriter(new FileWriter(fileOutName));

				//User enters message they want to Encode
				System.out.print("Enter the message you want to encode. ");
				input = scan.nextLine();

				// This method encrypts the user's message
				encryptMethod = encryptMessage(input, alphabetIndex, keyEncoded);

				
				// Returns Encrypted Message to Console
				System.out.println("Enclosed Message: " + encryptMethod);
				System.out.println("");
				System.out.println("");

				//Prints encrypted message to user created file
				outputStream.println("Your original Message: " + input);
				outputStream.println("");
				outputStream.println("Encrypted Message: " + encryptMethod);
				
				
				//Restarts program
				System.out.print("Enter E to encode a message. \n");
				System.out.print("Enter D to decode a message. \n");
				System.out.print("Enter Q to quit the program. \n");
				System.out.print("Enter your choice:");
				input = scan.nextLine();
				
			
				
			}

			catch (IOException noFile) {
				System.out.println("File was not found or could not be opened.");
			}
			
			
			

			finally {

				if (in != null && input.charAt(0) == 'q') 
					in.close();
					outputStream.close();

				}
			
			
			
			
			
			}
			
		
		
		
		}while (input.charAt(0) == 'e' || input.charAt(0) == 'd');
		
		
}
		System.out.println("");
		System.out.print("Thank you, Good-Bye!");
		
		
		
	}
	
	

}
