package secretWriting;

import java.util.Scanner;
import java.lang.Throwable;
import java.io.*;

public class SecretWriting {

	// Method for encoding User's message
	public static String encryptMessage(String userInput, String originalAlphabet, String keyEncoded) {
		String spaceOutput = "";

		for (int i = 0; i < userInput.length(); i++) {

			char keyCharacter;
			char messageCharacter = userInput.charAt(i);
			int inputIndex = originalAlphabet.indexOf(messageCharacter);
			try {

				keyCharacter = keyEncoded.charAt(inputIndex);

			} catch (StringIndexOutOfBoundsException e) {

				keyCharacter = messageCharacter;

			}

			spaceOutput += keyCharacter;

		}

		return spaceOutput;

	}

	public static void main(String[] args) throws IOException {

		// Introduction
		System.out.print("Welcome to the Encoder/ Decoder Program \n");
		System.out.print("-----------------------------------------\n");

		System.out.print("Enter E to encode a message. \n");
		System.out.print("Enter D to decode a message. \n");
		System.out.print("Enter Q to quit the program. \n");
		System.out.print("Enter your choice:");

		// User input
		Scanner scan = new Scanner(System.in);
		String input = scan.nextLine();
		String fileOutName;

		// File Name from User Inputs

		if (input.charAt(0) == 'E' || input.charAt(0) == 'e') {

			// Create input and output file streams
			BufferedReader in = null;
			PrintWriter outputStream = null;
			String encryptMethod;

			try {
				System.out.print("Enter the name of the file that contains the code:");
				input = scan.nextLine();

				// User puts the name of the file they are searching for
				in = new BufferedReader(new FileReader(input));
				String keyEncoded = in.readLine();

				String alphabetIndex = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";

				// User puts the name of the output file
				System.out.print("Enter the name of the output file:");
				fileOutName = scan.nextLine();
				outputStream = new PrintWriter(new FileWriter(fileOutName));

				System.out.print("Enter the message you want to encode. ");
				input = scan.nextLine();

				// method encrypts message
				encryptMethod = encryptMessage(input, alphabetIndex, keyEncoded);

				System.out.print("Enclosed Message: " + encryptMethod);

				outputStream.println(encryptMethod);

			}

			catch (IOException noFile) {
				System.out.println("File was not found or could not be opened.");
			}

			finally {

				if (in != null) {
					in.close();
					scan.close();
					outputStream.close();

				}

			}

		}

	}

}
